<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>bci_essentials.signal_processing API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../bci_essentials.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;bci_essentials</a>

            <img src="https://avatars.githubusercontent.com/u/65678973" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#logger">logger</a>
            </li>
            <li>
                    <a class="function" href="#validate_filter_input">validate_filter_input</a>
            </li>
            <li>
                    <a class="function" href="#bandpass">bandpass</a>
            </li>
            <li>
                    <a class="function" href="#lowpass">lowpass</a>
            </li>
            <li>
                    <a class="function" href="#highpass">highpass</a>
            </li>
            <li>
                    <a class="function" href="#notch">notch</a>
            </li>
            <li>
                    <a class="function" href="#lico">lico</a>
            </li>
            <li>
                    <a class="function" href="#smote">smote</a>
            </li>
            <li>
                    <a class="function" href="#random_oversampling">random_oversampling</a>
            </li>
            <li>
                    <a class="function" href="#random_undersampling">random_undersampling</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../bci_essentials.html">bci_essentials</a><wbr>.signal_processing    </h1>

                        <div class="docstring"><p>Signal processing tools for processing trials of EEG data.</p>

<p>The EEG data inputs can be 2D or 3D arrays.</p>

<ul>
<li>For single trials, inputs are of the shape <code>n_channels x n_samples</code>, where:
<ul>
<li>n_channels = number of channels</li>
<li>n_samples = number of samples</li>
</ul></li>
<li>For multiple trials, inputs are of the shape <code>n_trials x n_channels x n_samples</code>, where:
<ul>
<li>n_trials = number of trials</li>
<li>n_channels = number of channels</li>
<li>n_samples = number of samples</li>
</ul></li>
</ul>

<ul>
<li>Outputs are the same dimensions as input (trials, channels, samples)</li>
</ul>
</div>

                        <input id="mod-signal_processing-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-signal_processing-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Signal processing tools for processing trials of EEG data.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">The EEG data inputs can be 2D or 3D arrays.</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">- For single trials, inputs are of the shape `n_channels x n_samples`, where:</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">    - n_channels = number of channels</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">    - n_samples = number of samples</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">- For multiple trials, inputs are of the shape `n_trials x n_channels x n_samples`, where:</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">    - n_trials = number of trials</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">    - n_channels = number of channels</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">    - n_samples = number of samples</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">- Outputs are the same dimensions as input (trials, channels, samples)</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">signal</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">imblearn.over_sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">SMOTE</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.utils.logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">Logger</span>  <span class="c1"># Logger wrapper</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="c1"># Instantiate a logger for the module at the default level of logging.INFO</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="c1"># Logs to bci_essentials.__module__) where __module__ is the name of the module</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="n">logger</span> <span class="o">=</span> <span class="n">Logger</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_filter_input</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to validate input data for filter functions.&quot;&quot;&quot;</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>                    <span class="sa">f</span><span class="s2">&quot;Input data for </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> must be a numpy array&quot;</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>                <span class="p">)</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]):</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>                    <span class="sa">f</span><span class="s2">&quot;Data shape for </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> must be 2D or 3D array&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>                <span class="p">)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>    <span class="k">return</span> <span class="n">wrapper</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="nd">@validate_filter_input</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="k">def</span><span class="w"> </span><span class="nf">bandpass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_low</span><span class="p">,</span> <span class="n">f_high</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Bandpass Filter.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    Filters out frequencies outside of the range f_low to f_high with a</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">    Butterworth filter of specific order.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">    Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    Parameters</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    ----------</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    f_low : float</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        Lower cut-off frequency.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    f_high : float</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        Upper cut-off frequency.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    order : int</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        Order of the filter.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    fsample : float</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">    Returns</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">    -------</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="n">Wn</span> <span class="o">=</span> <span class="p">[</span><span class="n">f_low</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">f_high</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;bandpass&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="nd">@validate_filter_input</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="k">def</span><span class="w"> </span><span class="nf">lowpass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_cutoff</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lowpass Filter.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">    Filters out frequencies above f_critical with a Butterworth filter of specific order.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    Parameters</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">    ----------</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">    f_cutoff : float</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        Cut-off frequency.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">    order : int</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Order of the filter.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">    fsample : float</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">    Returns</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">    -------</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="n">Wn</span> <span class="o">=</span> <span class="n">f_cutoff</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="nd">@validate_filter_input</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="k">def</span><span class="w"> </span><span class="nf">highpass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_cutoff</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Highpass Filter.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">    Filters out frequencies below f_critical with a Butterworth filter of specific order.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">    Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">    Parameters</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">    ----------</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">    f_cutoff : float</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        Cut-off frequency.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">    order : int</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        Order of the filter.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">    fsample : float</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">    Returns</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">    -------</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="n">Wn</span> <span class="o">=</span> <span class="n">f_cutoff</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="nd">@validate_filter_input</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="k">def</span><span class="w"> </span><span class="nf">notch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_notch</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Notch Filter.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">    Notch filter for removing specific frequency components.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">    Parameters</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">    ----------</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">    f_notch : float</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        Frequency of notch.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">    Q : float</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        Quality factor. Dimensionless parameter that characterizes</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">        notch filter -3 dB bandwidth bw relative to its</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        center frequency, Q = w0/bw.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">    fsample : float</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">    Returns</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">    -------</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        shape = (`n_trials`,`n_channels`,`n_samples`)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">iirnotch</span><span class="p">(</span><span class="n">f_notch</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fsample</span><span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="k">def</span><span class="w"> </span><span class="nf">lico</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">expansion_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sum_num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Linear Combination Oversampling (LiCO)</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">    Generates synthetic EEG trials from the minority class by creating weighted linear</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">    combinations of existing trials, with added Gaussian noise for variability.</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">    Automatically detects the minority class based on label distribution.</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">    Parameters</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">    ----------</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">    X : numpy.ndarray</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">    y : numpy.ndarray</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">    expansion_factor : int, *optional*</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        Controls the amount of oversampling for the minority class.</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">        The minority class size will be increased by this factor.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="sd">        - Default is `3`.</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">    sum_num : int, *optional*</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        Number of existing trials to combine for each synthetic trial.</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        Higher values create more complex combinations.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        - Default is `2`.</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">    shuffle : bool, *optional*</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        Whether to shuffle the final combined dataset.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        - Default is `False`.</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">    Returns</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">    -------</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">    over_X : numpy.ndarray</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        Original trials combined with synthetic trials.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        shape = (n_expanded_trials, n_channels, n_samples)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">    over_y : numpy.ndarray</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        Labels for original and synthetic trials.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        shape = (n_expanded_trials,)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>    <span class="c1"># Determine the minority class (class with the fewest samples)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Minority class: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">minority_class</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>    <span class="c1"># Select the original EEG trials only corresponding to the minority class</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="n">minority_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">]</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    <span class="c1"># Get the shape of the minority class data</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    <span class="n">n_minority</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">minority_X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Shape of minority class: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">minority_X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="c1"># Calculate number of new synthetic samples needed</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="n">n_synthetic_trials</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_minority</span> <span class="o">*</span> <span class="p">(</span><span class="n">expansion_factor</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="c1"># Initialize array for synthetic samples</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>    <span class="n">synthetic_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_synthetic_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">])</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Shape of synthetic trials: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">synthetic_X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>    <span class="c1"># Generate synthetic trials by combining minority class samples with LiCO</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>    <span class="k">for</span> <span class="n">trial_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_synthetic_trials</span><span class="p">):</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>        <span class="c1"># Generate random weights</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">sum_num</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="c1"># For each new trial, create a random combination of existing trials</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sum_num</span><span class="p">):</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="n">random_trial_idx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_minority</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="n">random_epoch</span> <span class="o">=</span> <span class="n">minority_X</span><span class="p">[</span><span class="n">random_trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">random_epoch</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        <span class="c1"># Add small noise for variability</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="c1"># noise = np.random.normal(0, 0.01, size=synthetic_X[trial_idx, :, :].shape)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">])</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">noise</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="c1"># Normalize the new sample</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>    <span class="c1"># Combine original data with synthetic data</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>    <span class="n">over_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">synthetic_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>    <span class="n">over_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n_synthetic_trials</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LiCO expanded data from </span><span class="si">%d</span><span class="s2"> to </span><span class="si">%d</span><span class="s2"> samples&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">over_y</span><span class="p">))</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Final class distribution: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">over_y</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>    <span class="c1"># Shuffle the data if requested</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>    <span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">over_y</span><span class="p">))</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="n">over_X</span> <span class="o">=</span> <span class="n">over_X</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">over_y</span> <span class="o">=</span> <span class="n">over_y</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>    <span class="k">return</span> <span class="n">over_X</span><span class="p">,</span> <span class="n">over_y</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="k">def</span><span class="w"> </span><span class="nf">smote</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">expansion_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Oversampling using SMOTE (Synthetic Minority Over-sampling Technique)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">    Generates synthetic EEG trials from minority class (typically target/P300 responses).</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">    Parameters</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">    ----------</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">    X : numpy.ndarray</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples)</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">    y : numpy.ndarray</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">    expansion_factor : float, *optional*</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">        Controls the amount of oversampling for the minority class.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        - Default is `3`.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">    k_neighbors : int, *optional*</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        Number of nearest neighbors to use for synthetic sample generation.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        - Default is `5`.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">    shuffle : bool, *optional*</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">        Whether to shuffle the final combined dataset.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">        - Default is `False`.</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">    random_state : int, *optional*</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        Random seed for reproducibility.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        - Default is `42`.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">    Returns</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">    -------</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">    over_X : numpy.ndarray</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">        Oversampled X.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">    over_y : numpy.ndarray</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">        Oversampled y.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>    <span class="c1"># Get dimensions</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>    <span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>    <span class="n">n_minority</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">)</span> <span class="o">*</span> <span class="n">expansion_factor</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>    <span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span><span class="n">minority_class</span><span class="p">:</span> <span class="n">n_minority</span><span class="p">}</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>    <span class="c1"># Reshape X to 2D for SMOTE (combine channels and samples)</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>    <span class="n">X_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>    <span class="c1"># Apply SMOTE</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="c1"># If not enough minority samples for k_neighbors, reduce k</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="k">if</span> <span class="n">n_minority</span> <span class="o">&lt;=</span> <span class="n">k_neighbors</span><span class="p">:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>            <span class="n">k_neighbors</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_minority</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                <span class="s2">&quot;Reduced k_neighbors to </span><span class="si">%s</span><span class="s2"> due to small minority class&quot;</span><span class="p">,</span> <span class="n">k_neighbors</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="c1"># Configure and apply SMOTE</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="n">sampling_strategy</span><span class="o">=</span><span class="n">sampling_strategy</span><span class="p">,</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="n">k_neighbors</span><span class="o">=</span><span class="n">k_neighbors</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="p">)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_reshaped</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="c1"># Reshape back to 3D</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="n">X_resampled</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="c1"># Shuffle if requested</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">))</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>            <span class="n">X_resampled</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>            <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">y_resampled</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>            <span class="s2">&quot;SMOTE expanded data from </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2"> samples&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;New class balance: </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_resampled</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">))</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>        <span class="k">return</span> <span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;SMOTE failed: </span><span class="si">%s</span><span class="s2">. Returning original data.&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="k">def</span><span class="w"> </span><span class="nf">random_oversampling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Oversampling</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">    Randomly samples epochs of X to oversample the MINORITY class.</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">    Automatically determines which class is the MINORITY class.</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">    Parameters</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">    ----------</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">    X : numpy.ndarray [n_trials, n_channels, n_samples]</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">    y : numpy.ndarray [n_trials]</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">    ratio : float</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        Desired ratio of MINORITY class samples to majority class samples</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        - ratio=1 means the number of MINORITY class samples will be equal to the number of majority class samples</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        - ratio=0.5 means the number of MINORITY class samples will be half the number of majority class samples</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        - ratio=2 means the number of MINORITY class samples will be twice the number of majority class samples</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">    Returns</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">    -------</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">    over_X : numpy.ndarray</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        Oversampled X.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">    over_y : numpy.ndarray</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        Oversampled y.</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>    <span class="c1"># Determine minority and majority classes</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>    <span class="n">n_minority</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>    <span class="n">n_majority</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>    <span class="c1"># Get minority class samples</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>    <span class="n">minority_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">]</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>    <span class="c1"># Calculate number of samples needed</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_majority</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_minority</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>    <span class="c1"># Generate new samples</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>    <span class="n">new_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="n">new_X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">minority_X</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_minority</span><span class="p">)),</span> <span class="p">:,</span> <span class="p">:]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>    <span class="n">over_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>    <span class="n">over_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n_samples</span><span class="p">])</span> <span class="o">*</span> <span class="n">minority_class</span><span class="p">)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>    <span class="k">return</span> <span class="n">over_X</span><span class="p">,</span> <span class="n">over_y</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="k">def</span><span class="w"> </span><span class="nf">random_undersampling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Undersampling</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">    Randomly removes epochs of X to undersample the MAJORITY class.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">    Automatically determines which class is the MAJORITYajority class.</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">    Parameters</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">    ----------</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">    X : numpy.ndarray [n_trials, n_channels, n_samples]</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">    y : numpy.ndarray [n_trials]</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">    ratio : float</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">        Desired ratio of MAJORITY class samples to minority class samples.</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        - ratio=1 means the number of MAJORITY class samples will be equal to the number of minority class samples</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">        - ratio=0.5 means the number of MAJORITY class samples will be half the number of minority class samples</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        - ratio=2 means the number of MAJORITY class samples will be twice the number of minority class samples</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">    Returns</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">    -------</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">    under_X : numpy.ndarray</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        Undersampled X.</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">    under_y : numpy.ndarray</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">        Undersampled y.</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>    <span class="c1"># Determine minority and majority classes</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>    <span class="n">majority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>    <span class="n">n_minority</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>    <span class="c1"># Calculate number of majority samples to keep</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_minority</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>    <span class="c1"># Get indices of majority class samples</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>    <span class="n">majority_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">majority_class</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>    <span class="c1"># Randomly select indices to keep</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>    <span class="n">keep_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">majority_indices</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>    <span class="c1"># Get indices of minority class samples</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>    <span class="n">minority_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>    <span class="c1"># Combine indices</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>    <span class="n">all_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">keep_indices</span><span class="p">,</span> <span class="n">minority_indices</span><span class="p">])</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>    <span class="c1"># Create undersampled datasets</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>    <span class="n">under_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">all_indices</span><span class="p">]</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>    <span class="n">under_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">all_indices</span><span class="p">]</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>    <span class="k">return</span> <span class="n">under_X</span><span class="p">,</span> <span class="n">under_y</span>
</span></pre></div>


            </section>
                <section id="logger">
                    <div class="attr variable">
            <span class="name">logger</span>        =
<span class="default_value">&lt;<a href="utils/logger.html#Logger">bci_essentials.utils.logger.Logger</a> object&gt;</span>

        
    </div>
    <a class="headerlink" href="#logger"></a>
    
    

                </section>
                <section id="validate_filter_input">
                            <input id="validate_filter_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validate_filter_input</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span></span><span class="return-annotation">) -> <span class="n">Callable</span>:</span></span>

                <label class="view-source-button" for="validate_filter_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#validate_filter_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="validate_filter_input-31"><a href="#validate_filter_input-31"><span class="linenos">31</span></a><span class="k">def</span><span class="w"> </span><span class="nf">validate_filter_input</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
</span><span id="validate_filter_input-32"><a href="#validate_filter_input-32"><span class="linenos">32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to validate input data for filter functions.&quot;&quot;&quot;</span>
</span><span id="validate_filter_input-33"><a href="#validate_filter_input-33"><span class="linenos">33</span></a>
</span><span id="validate_filter_input-34"><a href="#validate_filter_input-34"><span class="linenos">34</span></a>    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
</span><span id="validate_filter_input-35"><a href="#validate_filter_input-35"><span class="linenos">35</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
</span><span id="validate_filter_input-36"><a href="#validate_filter_input-36"><span class="linenos">36</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="validate_filter_input-37"><a href="#validate_filter_input-37"><span class="linenos">37</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="validate_filter_input-38"><a href="#validate_filter_input-38"><span class="linenos">38</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="validate_filter_input-39"><a href="#validate_filter_input-39"><span class="linenos">39</span></a>                    <span class="sa">f</span><span class="s2">&quot;Input data for </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> must be a numpy array&quot;</span>
</span><span id="validate_filter_input-40"><a href="#validate_filter_input-40"><span class="linenos">40</span></a>                <span class="p">)</span>
</span><span id="validate_filter_input-41"><a href="#validate_filter_input-41"><span class="linenos">41</span></a>
</span><span id="validate_filter_input-42"><a href="#validate_filter_input-42"><span class="linenos">42</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]):</span>
</span><span id="validate_filter_input-43"><a href="#validate_filter_input-43"><span class="linenos">43</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="validate_filter_input-44"><a href="#validate_filter_input-44"><span class="linenos">44</span></a>                    <span class="sa">f</span><span class="s2">&quot;Data shape for </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> must be 2D or 3D array&quot;</span>
</span><span id="validate_filter_input-45"><a href="#validate_filter_input-45"><span class="linenos">45</span></a>                <span class="p">)</span>
</span><span id="validate_filter_input-46"><a href="#validate_filter_input-46"><span class="linenos">46</span></a>
</span><span id="validate_filter_input-47"><a href="#validate_filter_input-47"><span class="linenos">47</span></a>            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="validate_filter_input-48"><a href="#validate_filter_input-48"><span class="linenos">48</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="validate_filter_input-49"><a href="#validate_filter_input-49"><span class="linenos">49</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">ERROR</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error in </span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="validate_filter_input-50"><a href="#validate_filter_input-50"><span class="linenos">50</span></a>            <span class="k">return</span> <span class="n">data</span>
</span><span id="validate_filter_input-51"><a href="#validate_filter_input-51"><span class="linenos">51</span></a>
</span><span id="validate_filter_input-52"><a href="#validate_filter_input-52"><span class="linenos">52</span></a>    <span class="k">return</span> <span class="n">wrapper</span>
</span></pre></div>


            <div class="docstring"><p>Decorator to validate input data for filter functions.</p>
</div>


                </section>
                <section id="bandpass">
                            <input id="bandpass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_filter_input">@validate_filter_input</div>

        <span class="def">def</span>
        <span class="name">bandpass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">f_low</span>, </span><span class="param"><span class="n">f_high</span>, </span><span class="param"><span class="n">order</span>, </span><span class="param"><span class="n">fsample</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="bandpass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#bandpass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="bandpass-55"><a href="#bandpass-55"><span class="linenos">55</span></a><span class="nd">@validate_filter_input</span>
</span><span id="bandpass-56"><a href="#bandpass-56"><span class="linenos">56</span></a><span class="k">def</span><span class="w"> </span><span class="nf">bandpass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_low</span><span class="p">,</span> <span class="n">f_high</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="bandpass-57"><a href="#bandpass-57"><span class="linenos">57</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Bandpass Filter.</span>
</span><span id="bandpass-58"><a href="#bandpass-58"><span class="linenos">58</span></a>
</span><span id="bandpass-59"><a href="#bandpass-59"><span class="linenos">59</span></a><span class="sd">    Filters out frequencies outside of the range f_low to f_high with a</span>
</span><span id="bandpass-60"><a href="#bandpass-60"><span class="linenos">60</span></a><span class="sd">    Butterworth filter of specific order.</span>
</span><span id="bandpass-61"><a href="#bandpass-61"><span class="linenos">61</span></a>
</span><span id="bandpass-62"><a href="#bandpass-62"><span class="linenos">62</span></a><span class="sd">    Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</span>
</span><span id="bandpass-63"><a href="#bandpass-63"><span class="linenos">63</span></a>
</span><span id="bandpass-64"><a href="#bandpass-64"><span class="linenos">64</span></a><span class="sd">    Parameters</span>
</span><span id="bandpass-65"><a href="#bandpass-65"><span class="linenos">65</span></a><span class="sd">    ----------</span>
</span><span id="bandpass-66"><a href="#bandpass-66"><span class="linenos">66</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="bandpass-67"><a href="#bandpass-67"><span class="linenos">67</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="bandpass-68"><a href="#bandpass-68"><span class="linenos">68</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="bandpass-69"><a href="#bandpass-69"><span class="linenos">69</span></a>
</span><span id="bandpass-70"><a href="#bandpass-70"><span class="linenos">70</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="bandpass-71"><a href="#bandpass-71"><span class="linenos">71</span></a><span class="sd">    f_low : float</span>
</span><span id="bandpass-72"><a href="#bandpass-72"><span class="linenos">72</span></a><span class="sd">        Lower cut-off frequency.</span>
</span><span id="bandpass-73"><a href="#bandpass-73"><span class="linenos">73</span></a><span class="sd">    f_high : float</span>
</span><span id="bandpass-74"><a href="#bandpass-74"><span class="linenos">74</span></a><span class="sd">        Upper cut-off frequency.</span>
</span><span id="bandpass-75"><a href="#bandpass-75"><span class="linenos">75</span></a><span class="sd">    order : int</span>
</span><span id="bandpass-76"><a href="#bandpass-76"><span class="linenos">76</span></a><span class="sd">        Order of the filter.</span>
</span><span id="bandpass-77"><a href="#bandpass-77"><span class="linenos">77</span></a><span class="sd">    fsample : float</span>
</span><span id="bandpass-78"><a href="#bandpass-78"><span class="linenos">78</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="bandpass-79"><a href="#bandpass-79"><span class="linenos">79</span></a>
</span><span id="bandpass-80"><a href="#bandpass-80"><span class="linenos">80</span></a><span class="sd">    Returns</span>
</span><span id="bandpass-81"><a href="#bandpass-81"><span class="linenos">81</span></a><span class="sd">    -------</span>
</span><span id="bandpass-82"><a href="#bandpass-82"><span class="linenos">82</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="bandpass-83"><a href="#bandpass-83"><span class="linenos">83</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="bandpass-84"><a href="#bandpass-84"><span class="linenos">84</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="bandpass-85"><a href="#bandpass-85"><span class="linenos">85</span></a>
</span><span id="bandpass-86"><a href="#bandpass-86"><span class="linenos">86</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="bandpass-87"><a href="#bandpass-87"><span class="linenos">87</span></a>
</span><span id="bandpass-88"><a href="#bandpass-88"><span class="linenos">88</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="bandpass-89"><a href="#bandpass-89"><span class="linenos">89</span></a>    <span class="n">Wn</span> <span class="o">=</span> <span class="p">[</span><span class="n">f_low</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">f_high</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>
</span><span id="bandpass-90"><a href="#bandpass-90"><span class="linenos">90</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;bandpass&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="bandpass-91"><a href="#bandpass-91"><span class="linenos">91</span></a>
</span><span id="bandpass-92"><a href="#bandpass-92"><span class="linenos">92</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="bandpass-93"><a href="#bandpass-93"><span class="linenos">93</span></a>
</span><span id="bandpass-94"><a href="#bandpass-94"><span class="linenos">94</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span></pre></div>


            <div class="docstring"><p>Bandpass Filter.</p>

<p>Filters out frequencies outside of the range f_low to f_high with a
Butterworth filter of specific order.</p>

<p>Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>data</strong> (numpy.ndarray):
Trials of EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
<li><strong>f_low</strong> (float):
Lower cut-off frequency.</li>
<li><strong>f_high</strong> (float):
Upper cut-off frequency.</li>
<li><strong>order</strong> (int):
Order of the filter.</li>
<li><strong>fsample</strong> (float):
Sampling rate of signal.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><p><strong>new_data</strong> (numpy.ndarray):
Trials of filtered EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
</ul>
</div>


                </section>
                <section id="lowpass">
                            <input id="lowpass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_filter_input">@validate_filter_input</div>

        <span class="def">def</span>
        <span class="name">lowpass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">f_cutoff</span>, </span><span class="param"><span class="n">order</span>, </span><span class="param"><span class="n">fsample</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="lowpass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#lowpass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="lowpass-97"><a href="#lowpass-97"><span class="linenos"> 97</span></a><span class="nd">@validate_filter_input</span>
</span><span id="lowpass-98"><a href="#lowpass-98"><span class="linenos"> 98</span></a><span class="k">def</span><span class="w"> </span><span class="nf">lowpass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_cutoff</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="lowpass-99"><a href="#lowpass-99"><span class="linenos"> 99</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Lowpass Filter.</span>
</span><span id="lowpass-100"><a href="#lowpass-100"><span class="linenos">100</span></a>
</span><span id="lowpass-101"><a href="#lowpass-101"><span class="linenos">101</span></a><span class="sd">    Filters out frequencies above f_critical with a Butterworth filter of specific order.</span>
</span><span id="lowpass-102"><a href="#lowpass-102"><span class="linenos">102</span></a>
</span><span id="lowpass-103"><a href="#lowpass-103"><span class="linenos">103</span></a><span class="sd">    Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</span>
</span><span id="lowpass-104"><a href="#lowpass-104"><span class="linenos">104</span></a>
</span><span id="lowpass-105"><a href="#lowpass-105"><span class="linenos">105</span></a><span class="sd">    Parameters</span>
</span><span id="lowpass-106"><a href="#lowpass-106"><span class="linenos">106</span></a><span class="sd">    ----------</span>
</span><span id="lowpass-107"><a href="#lowpass-107"><span class="linenos">107</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="lowpass-108"><a href="#lowpass-108"><span class="linenos">108</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="lowpass-109"><a href="#lowpass-109"><span class="linenos">109</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="lowpass-110"><a href="#lowpass-110"><span class="linenos">110</span></a>
</span><span id="lowpass-111"><a href="#lowpass-111"><span class="linenos">111</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="lowpass-112"><a href="#lowpass-112"><span class="linenos">112</span></a><span class="sd">    f_cutoff : float</span>
</span><span id="lowpass-113"><a href="#lowpass-113"><span class="linenos">113</span></a><span class="sd">        Cut-off frequency.</span>
</span><span id="lowpass-114"><a href="#lowpass-114"><span class="linenos">114</span></a><span class="sd">    order : int</span>
</span><span id="lowpass-115"><a href="#lowpass-115"><span class="linenos">115</span></a><span class="sd">        Order of the filter.</span>
</span><span id="lowpass-116"><a href="#lowpass-116"><span class="linenos">116</span></a><span class="sd">    fsample : float</span>
</span><span id="lowpass-117"><a href="#lowpass-117"><span class="linenos">117</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="lowpass-118"><a href="#lowpass-118"><span class="linenos">118</span></a>
</span><span id="lowpass-119"><a href="#lowpass-119"><span class="linenos">119</span></a><span class="sd">    Returns</span>
</span><span id="lowpass-120"><a href="#lowpass-120"><span class="linenos">120</span></a><span class="sd">    -------</span>
</span><span id="lowpass-121"><a href="#lowpass-121"><span class="linenos">121</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="lowpass-122"><a href="#lowpass-122"><span class="linenos">122</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="lowpass-123"><a href="#lowpass-123"><span class="linenos">123</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="lowpass-124"><a href="#lowpass-124"><span class="linenos">124</span></a>
</span><span id="lowpass-125"><a href="#lowpass-125"><span class="linenos">125</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="lowpass-126"><a href="#lowpass-126"><span class="linenos">126</span></a>
</span><span id="lowpass-127"><a href="#lowpass-127"><span class="linenos">127</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="lowpass-128"><a href="#lowpass-128"><span class="linenos">128</span></a>    <span class="n">Wn</span> <span class="o">=</span> <span class="n">f_cutoff</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="lowpass-129"><a href="#lowpass-129"><span class="linenos">129</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;lowpass&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="lowpass-130"><a href="#lowpass-130"><span class="linenos">130</span></a>
</span><span id="lowpass-131"><a href="#lowpass-131"><span class="linenos">131</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="lowpass-132"><a href="#lowpass-132"><span class="linenos">132</span></a>
</span><span id="lowpass-133"><a href="#lowpass-133"><span class="linenos">133</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span></pre></div>


            <div class="docstring"><p>Lowpass Filter.</p>

<p>Filters out frequencies above f_critical with a Butterworth filter of specific order.</p>

<p>Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>data</strong> (numpy.ndarray):
Trials of EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
<li><strong>f_cutoff</strong> (float):
Cut-off frequency.</li>
<li><strong>order</strong> (int):
Order of the filter.</li>
<li><strong>fsample</strong> (float):
Sampling rate of signal.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><p><strong>new_data</strong> (numpy.ndarray):
Trials of filtered EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
</ul>
</div>


                </section>
                <section id="highpass">
                            <input id="highpass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_filter_input">@validate_filter_input</div>

        <span class="def">def</span>
        <span class="name">highpass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">f_cutoff</span>, </span><span class="param"><span class="n">order</span>, </span><span class="param"><span class="n">fsample</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="highpass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#highpass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="highpass-136"><a href="#highpass-136"><span class="linenos">136</span></a><span class="nd">@validate_filter_input</span>
</span><span id="highpass-137"><a href="#highpass-137"><span class="linenos">137</span></a><span class="k">def</span><span class="w"> </span><span class="nf">highpass</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_cutoff</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="highpass-138"><a href="#highpass-138"><span class="linenos">138</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Highpass Filter.</span>
</span><span id="highpass-139"><a href="#highpass-139"><span class="linenos">139</span></a>
</span><span id="highpass-140"><a href="#highpass-140"><span class="linenos">140</span></a><span class="sd">    Filters out frequencies below f_critical with a Butterworth filter of specific order.</span>
</span><span id="highpass-141"><a href="#highpass-141"><span class="linenos">141</span></a>
</span><span id="highpass-142"><a href="#highpass-142"><span class="linenos">142</span></a><span class="sd">    Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</span>
</span><span id="highpass-143"><a href="#highpass-143"><span class="linenos">143</span></a>
</span><span id="highpass-144"><a href="#highpass-144"><span class="linenos">144</span></a><span class="sd">    Parameters</span>
</span><span id="highpass-145"><a href="#highpass-145"><span class="linenos">145</span></a><span class="sd">    ----------</span>
</span><span id="highpass-146"><a href="#highpass-146"><span class="linenos">146</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="highpass-147"><a href="#highpass-147"><span class="linenos">147</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="highpass-148"><a href="#highpass-148"><span class="linenos">148</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="highpass-149"><a href="#highpass-149"><span class="linenos">149</span></a>
</span><span id="highpass-150"><a href="#highpass-150"><span class="linenos">150</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="highpass-151"><a href="#highpass-151"><span class="linenos">151</span></a><span class="sd">    f_cutoff : float</span>
</span><span id="highpass-152"><a href="#highpass-152"><span class="linenos">152</span></a><span class="sd">        Cut-off frequency.</span>
</span><span id="highpass-153"><a href="#highpass-153"><span class="linenos">153</span></a><span class="sd">    order : int</span>
</span><span id="highpass-154"><a href="#highpass-154"><span class="linenos">154</span></a><span class="sd">        Order of the filter.</span>
</span><span id="highpass-155"><a href="#highpass-155"><span class="linenos">155</span></a><span class="sd">    fsample : float</span>
</span><span id="highpass-156"><a href="#highpass-156"><span class="linenos">156</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="highpass-157"><a href="#highpass-157"><span class="linenos">157</span></a>
</span><span id="highpass-158"><a href="#highpass-158"><span class="linenos">158</span></a><span class="sd">    Returns</span>
</span><span id="highpass-159"><a href="#highpass-159"><span class="linenos">159</span></a><span class="sd">    -------</span>
</span><span id="highpass-160"><a href="#highpass-160"><span class="linenos">160</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="highpass-161"><a href="#highpass-161"><span class="linenos">161</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="highpass-162"><a href="#highpass-162"><span class="linenos">162</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="highpass-163"><a href="#highpass-163"><span class="linenos">163</span></a>
</span><span id="highpass-164"><a href="#highpass-164"><span class="linenos">164</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="highpass-165"><a href="#highpass-165"><span class="linenos">165</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="highpass-166"><a href="#highpass-166"><span class="linenos">166</span></a>    <span class="n">Wn</span> <span class="o">=</span> <span class="n">f_cutoff</span> <span class="o">/</span> <span class="p">(</span><span class="n">fsample</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="highpass-167"><a href="#highpass-167"><span class="linenos">167</span></a>    <span class="n">sos</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s2">&quot;highpass&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;sos&quot;</span><span class="p">)</span>
</span><span id="highpass-168"><a href="#highpass-168"><span class="linenos">168</span></a>
</span><span id="highpass-169"><a href="#highpass-169"><span class="linenos">169</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">sosfiltfilt</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="highpass-170"><a href="#highpass-170"><span class="linenos">170</span></a>
</span><span id="highpass-171"><a href="#highpass-171"><span class="linenos">171</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span></pre></div>


            <div class="docstring"><p>Highpass Filter.</p>

<p>Filters out frequencies below f_critical with a Butterworth filter of specific order.</p>

<p>Wraps the scipy.signal.butter and scipy.signal.sosfiltfilt methods.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>data</strong> (numpy.ndarray):
Trials of EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
<li><strong>f_cutoff</strong> (float):
Cut-off frequency.</li>
<li><strong>order</strong> (int):
Order of the filter.</li>
<li><strong>fsample</strong> (float):
Sampling rate of signal.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><p><strong>new_data</strong> (numpy.ndarray):
Trials of filtered EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
</ul>
</div>


                </section>
                <section id="notch">
                            <input id="notch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-validate_filter_input">@validate_filter_input</div>

        <span class="def">def</span>
        <span class="name">notch</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data</span>, </span><span class="param"><span class="n">f_notch</span>, </span><span class="param"><span class="n">Q</span>, </span><span class="param"><span class="n">fsample</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="notch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#notch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="notch-174"><a href="#notch-174"><span class="linenos">174</span></a><span class="nd">@validate_filter_input</span>
</span><span id="notch-175"><a href="#notch-175"><span class="linenos">175</span></a><span class="k">def</span><span class="w"> </span><span class="nf">notch</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f_notch</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fsample</span><span class="p">):</span>
</span><span id="notch-176"><a href="#notch-176"><span class="linenos">176</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Notch Filter.</span>
</span><span id="notch-177"><a href="#notch-177"><span class="linenos">177</span></a>
</span><span id="notch-178"><a href="#notch-178"><span class="linenos">178</span></a><span class="sd">    Notch filter for removing specific frequency components.</span>
</span><span id="notch-179"><a href="#notch-179"><span class="linenos">179</span></a>
</span><span id="notch-180"><a href="#notch-180"><span class="linenos">180</span></a><span class="sd">    Parameters</span>
</span><span id="notch-181"><a href="#notch-181"><span class="linenos">181</span></a><span class="sd">    ----------</span>
</span><span id="notch-182"><a href="#notch-182"><span class="linenos">182</span></a><span class="sd">    data : numpy.ndarray</span>
</span><span id="notch-183"><a href="#notch-183"><span class="linenos">183</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="notch-184"><a href="#notch-184"><span class="linenos">184</span></a><span class="sd">        3D (or 2D) array containing data with `float` type.</span>
</span><span id="notch-185"><a href="#notch-185"><span class="linenos">185</span></a>
</span><span id="notch-186"><a href="#notch-186"><span class="linenos">186</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</span>
</span><span id="notch-187"><a href="#notch-187"><span class="linenos">187</span></a><span class="sd">    f_notch : float</span>
</span><span id="notch-188"><a href="#notch-188"><span class="linenos">188</span></a><span class="sd">        Frequency of notch.</span>
</span><span id="notch-189"><a href="#notch-189"><span class="linenos">189</span></a><span class="sd">    Q : float</span>
</span><span id="notch-190"><a href="#notch-190"><span class="linenos">190</span></a><span class="sd">        Quality factor. Dimensionless parameter that characterizes</span>
</span><span id="notch-191"><a href="#notch-191"><span class="linenos">191</span></a><span class="sd">        notch filter -3 dB bandwidth bw relative to its</span>
</span><span id="notch-192"><a href="#notch-192"><span class="linenos">192</span></a><span class="sd">        center frequency, Q = w0/bw.</span>
</span><span id="notch-193"><a href="#notch-193"><span class="linenos">193</span></a><span class="sd">    fsample : float</span>
</span><span id="notch-194"><a href="#notch-194"><span class="linenos">194</span></a><span class="sd">        Sampling rate of signal.</span>
</span><span id="notch-195"><a href="#notch-195"><span class="linenos">195</span></a>
</span><span id="notch-196"><a href="#notch-196"><span class="linenos">196</span></a><span class="sd">    Returns</span>
</span><span id="notch-197"><a href="#notch-197"><span class="linenos">197</span></a><span class="sd">    -------</span>
</span><span id="notch-198"><a href="#notch-198"><span class="linenos">198</span></a><span class="sd">    new_data : numpy.ndarray</span>
</span><span id="notch-199"><a href="#notch-199"><span class="linenos">199</span></a><span class="sd">        Trials of filtered EEG data.</span>
</span><span id="notch-200"><a href="#notch-200"><span class="linenos">200</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="notch-201"><a href="#notch-201"><span class="linenos">201</span></a>
</span><span id="notch-202"><a href="#notch-202"><span class="linenos">202</span></a><span class="sd">        shape = (`n_trials`,`n_channels`,`n_samples`)</span>
</span><span id="notch-203"><a href="#notch-203"><span class="linenos">203</span></a>
</span><span id="notch-204"><a href="#notch-204"><span class="linenos">204</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="notch-205"><a href="#notch-205"><span class="linenos">205</span></a>
</span><span id="notch-206"><a href="#notch-206"><span class="linenos">206</span></a>    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">iirnotch</span><span class="p">(</span><span class="n">f_notch</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fsample</span><span class="p">)</span>
</span><span id="notch-207"><a href="#notch-207"><span class="linenos">207</span></a>    <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">padlen</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="notch-208"><a href="#notch-208"><span class="linenos">208</span></a>
</span><span id="notch-209"><a href="#notch-209"><span class="linenos">209</span></a>    <span class="k">return</span> <span class="n">filtered_data</span>
</span></pre></div>


            <div class="docstring"><p>Notch Filter.</p>

<p>Notch filter for removing specific frequency components.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>data</strong> (numpy.ndarray):
Trials of EEG data.
3D (or 2D) array containing data with <code>float</code> type.</p>

<p>shape = (n_trials, n_channels, n_samples) or (n_channels, n_samples)</p></li>
<li><strong>f_notch</strong> (float):
Frequency of notch.</li>
<li><strong>Q</strong> (float):
Quality factor. Dimensionless parameter that characterizes
notch filter -3 dB bandwidth bw relative to its
center frequency, Q = w0/bw.</li>
<li><strong>fsample</strong> (float):
Sampling rate of signal.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><p><strong>new_data</strong> (numpy.ndarray):
Trials of filtered EEG data.
3D array containing data with <code>float</code> type.</p>

<p>shape = (<code>n_trials</code>,<code>n_channels</code>,<code>n_samples</code>)</p></li>
</ul>
</div>


                </section>
                <section id="lico">
                            <input id="lico-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lico</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">expansion_factor</span><span class="o">=</span><span class="mi">3</span>, </span><span class="param"><span class="n">sum_num</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="lico-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#lico"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="lico-212"><a href="#lico-212"><span class="linenos">212</span></a><span class="k">def</span><span class="w"> </span><span class="nf">lico</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">expansion_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sum_num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="lico-213"><a href="#lico-213"><span class="linenos">213</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Linear Combination Oversampling (LiCO)</span>
</span><span id="lico-214"><a href="#lico-214"><span class="linenos">214</span></a>
</span><span id="lico-215"><a href="#lico-215"><span class="linenos">215</span></a><span class="sd">    Generates synthetic EEG trials from the minority class by creating weighted linear</span>
</span><span id="lico-216"><a href="#lico-216"><span class="linenos">216</span></a><span class="sd">    combinations of existing trials, with added Gaussian noise for variability.</span>
</span><span id="lico-217"><a href="#lico-217"><span class="linenos">217</span></a><span class="sd">    Automatically detects the minority class based on label distribution.</span>
</span><span id="lico-218"><a href="#lico-218"><span class="linenos">218</span></a>
</span><span id="lico-219"><a href="#lico-219"><span class="linenos">219</span></a><span class="sd">    Parameters</span>
</span><span id="lico-220"><a href="#lico-220"><span class="linenos">220</span></a><span class="sd">    ----------</span>
</span><span id="lico-221"><a href="#lico-221"><span class="linenos">221</span></a><span class="sd">    X : numpy.ndarray</span>
</span><span id="lico-222"><a href="#lico-222"><span class="linenos">222</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="lico-223"><a href="#lico-223"><span class="linenos">223</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="lico-224"><a href="#lico-224"><span class="linenos">224</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples)</span>
</span><span id="lico-225"><a href="#lico-225"><span class="linenos">225</span></a><span class="sd">    y : numpy.ndarray</span>
</span><span id="lico-226"><a href="#lico-226"><span class="linenos">226</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="lico-227"><a href="#lico-227"><span class="linenos">227</span></a><span class="sd">    expansion_factor : int, *optional*</span>
</span><span id="lico-228"><a href="#lico-228"><span class="linenos">228</span></a><span class="sd">        Controls the amount of oversampling for the minority class.</span>
</span><span id="lico-229"><a href="#lico-229"><span class="linenos">229</span></a><span class="sd">        The minority class size will be increased by this factor.</span>
</span><span id="lico-230"><a href="#lico-230"><span class="linenos">230</span></a><span class="sd">        - Default is `3`.</span>
</span><span id="lico-231"><a href="#lico-231"><span class="linenos">231</span></a><span class="sd">    sum_num : int, *optional*</span>
</span><span id="lico-232"><a href="#lico-232"><span class="linenos">232</span></a><span class="sd">        Number of existing trials to combine for each synthetic trial.</span>
</span><span id="lico-233"><a href="#lico-233"><span class="linenos">233</span></a><span class="sd">        Higher values create more complex combinations.</span>
</span><span id="lico-234"><a href="#lico-234"><span class="linenos">234</span></a><span class="sd">        - Default is `2`.</span>
</span><span id="lico-235"><a href="#lico-235"><span class="linenos">235</span></a><span class="sd">    shuffle : bool, *optional*</span>
</span><span id="lico-236"><a href="#lico-236"><span class="linenos">236</span></a><span class="sd">        Whether to shuffle the final combined dataset.</span>
</span><span id="lico-237"><a href="#lico-237"><span class="linenos">237</span></a><span class="sd">        - Default is `False`.</span>
</span><span id="lico-238"><a href="#lico-238"><span class="linenos">238</span></a>
</span><span id="lico-239"><a href="#lico-239"><span class="linenos">239</span></a><span class="sd">    Returns</span>
</span><span id="lico-240"><a href="#lico-240"><span class="linenos">240</span></a><span class="sd">    -------</span>
</span><span id="lico-241"><a href="#lico-241"><span class="linenos">241</span></a><span class="sd">    over_X : numpy.ndarray</span>
</span><span id="lico-242"><a href="#lico-242"><span class="linenos">242</span></a><span class="sd">        Original trials combined with synthetic trials.</span>
</span><span id="lico-243"><a href="#lico-243"><span class="linenos">243</span></a><span class="sd">        shape = (n_expanded_trials, n_channels, n_samples)</span>
</span><span id="lico-244"><a href="#lico-244"><span class="linenos">244</span></a><span class="sd">    over_y : numpy.ndarray</span>
</span><span id="lico-245"><a href="#lico-245"><span class="linenos">245</span></a><span class="sd">        Labels for original and synthetic trials.</span>
</span><span id="lico-246"><a href="#lico-246"><span class="linenos">246</span></a><span class="sd">        shape = (n_expanded_trials,)</span>
</span><span id="lico-247"><a href="#lico-247"><span class="linenos">247</span></a>
</span><span id="lico-248"><a href="#lico-248"><span class="linenos">248</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="lico-249"><a href="#lico-249"><span class="linenos">249</span></a>
</span><span id="lico-250"><a href="#lico-250"><span class="linenos">250</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="lico-251"><a href="#lico-251"><span class="linenos">251</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="lico-252"><a href="#lico-252"><span class="linenos">252</span></a>
</span><span id="lico-253"><a href="#lico-253"><span class="linenos">253</span></a>    <span class="c1"># Determine the minority class (class with the fewest samples)</span>
</span><span id="lico-254"><a href="#lico-254"><span class="linenos">254</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="lico-255"><a href="#lico-255"><span class="linenos">255</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Minority class: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">minority_class</span><span class="p">)</span>
</span><span id="lico-256"><a href="#lico-256"><span class="linenos">256</span></a>    <span class="c1"># Select the original EEG trials only corresponding to the minority class</span>
</span><span id="lico-257"><a href="#lico-257"><span class="linenos">257</span></a>    <span class="n">minority_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">]</span>
</span><span id="lico-258"><a href="#lico-258"><span class="linenos">258</span></a>    <span class="c1"># Get the shape of the minority class data</span>
</span><span id="lico-259"><a href="#lico-259"><span class="linenos">259</span></a>    <span class="n">n_minority</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">minority_X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="lico-260"><a href="#lico-260"><span class="linenos">260</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Shape of minority class: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">minority_X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="lico-261"><a href="#lico-261"><span class="linenos">261</span></a>
</span><span id="lico-262"><a href="#lico-262"><span class="linenos">262</span></a>    <span class="c1"># Calculate number of new synthetic samples needed</span>
</span><span id="lico-263"><a href="#lico-263"><span class="linenos">263</span></a>    <span class="n">n_synthetic_trials</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_minority</span> <span class="o">*</span> <span class="p">(</span><span class="n">expansion_factor</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="lico-264"><a href="#lico-264"><span class="linenos">264</span></a>    <span class="c1"># Initialize array for synthetic samples</span>
</span><span id="lico-265"><a href="#lico-265"><span class="linenos">265</span></a>    <span class="n">synthetic_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_synthetic_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">])</span>
</span><span id="lico-266"><a href="#lico-266"><span class="linenos">266</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Shape of synthetic trials: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">synthetic_X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="lico-267"><a href="#lico-267"><span class="linenos">267</span></a>
</span><span id="lico-268"><a href="#lico-268"><span class="linenos">268</span></a>    <span class="c1"># Generate synthetic trials by combining minority class samples with LiCO</span>
</span><span id="lico-269"><a href="#lico-269"><span class="linenos">269</span></a>    <span class="k">for</span> <span class="n">trial_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_synthetic_trials</span><span class="p">):</span>
</span><span id="lico-270"><a href="#lico-270"><span class="linenos">270</span></a>        <span class="c1"># Generate random weights</span>
</span><span id="lico-271"><a href="#lico-271"><span class="linenos">271</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">dirichlet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">sum_num</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="lico-272"><a href="#lico-272"><span class="linenos">272</span></a>
</span><span id="lico-273"><a href="#lico-273"><span class="linenos">273</span></a>        <span class="c1"># For each new trial, create a random combination of existing trials</span>
</span><span id="lico-274"><a href="#lico-274"><span class="linenos">274</span></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sum_num</span><span class="p">):</span>
</span><span id="lico-275"><a href="#lico-275"><span class="linenos">275</span></a>            <span class="n">random_trial_idx</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_minority</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="lico-276"><a href="#lico-276"><span class="linenos">276</span></a>            <span class="n">random_epoch</span> <span class="o">=</span> <span class="n">minority_X</span><span class="p">[</span><span class="n">random_trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
</span><span id="lico-277"><a href="#lico-277"><span class="linenos">277</span></a>            <span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">weights</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">random_epoch</span>
</span><span id="lico-278"><a href="#lico-278"><span class="linenos">278</span></a>
</span><span id="lico-279"><a href="#lico-279"><span class="linenos">279</span></a>        <span class="c1"># Add small noise for variability</span>
</span><span id="lico-280"><a href="#lico-280"><span class="linenos">280</span></a>        <span class="c1"># noise = np.random.normal(0, 0.01, size=synthetic_X[trial_idx, :, :].shape)</span>
</span><span id="lico-281"><a href="#lico-281"><span class="linenos">281</span></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">])</span>
</span><span id="lico-282"><a href="#lico-282"><span class="linenos">282</span></a>        <span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">noise</span>
</span><span id="lico-283"><a href="#lico-283"><span class="linenos">283</span></a>
</span><span id="lico-284"><a href="#lico-284"><span class="linenos">284</span></a>        <span class="c1"># Normalize the new sample</span>
</span><span id="lico-285"><a href="#lico-285"><span class="linenos">285</span></a>        <span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">synthetic_X</span><span class="p">[</span><span class="n">trial_idx</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
</span><span id="lico-286"><a href="#lico-286"><span class="linenos">286</span></a>
</span><span id="lico-287"><a href="#lico-287"><span class="linenos">287</span></a>    <span class="c1"># Combine original data with synthetic data</span>
</span><span id="lico-288"><a href="#lico-288"><span class="linenos">288</span></a>    <span class="n">over_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">synthetic_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="lico-289"><a href="#lico-289"><span class="linenos">289</span></a>    <span class="n">over_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n_synthetic_trials</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">))</span>
</span><span id="lico-290"><a href="#lico-290"><span class="linenos">290</span></a>
</span><span id="lico-291"><a href="#lico-291"><span class="linenos">291</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;LiCO expanded data from </span><span class="si">%d</span><span class="s2"> to </span><span class="si">%d</span><span class="s2"> samples&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">over_y</span><span class="p">))</span>
</span><span id="lico-292"><a href="#lico-292"><span class="linenos">292</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Final class distribution: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">over_y</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</span><span id="lico-293"><a href="#lico-293"><span class="linenos">293</span></a>
</span><span id="lico-294"><a href="#lico-294"><span class="linenos">294</span></a>    <span class="c1"># Shuffle the data if requested</span>
</span><span id="lico-295"><a href="#lico-295"><span class="linenos">295</span></a>    <span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span>
</span><span id="lico-296"><a href="#lico-296"><span class="linenos">296</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">over_y</span><span class="p">))</span>
</span><span id="lico-297"><a href="#lico-297"><span class="linenos">297</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="lico-298"><a href="#lico-298"><span class="linenos">298</span></a>
</span><span id="lico-299"><a href="#lico-299"><span class="linenos">299</span></a>        <span class="n">over_X</span> <span class="o">=</span> <span class="n">over_X</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="lico-300"><a href="#lico-300"><span class="linenos">300</span></a>        <span class="n">over_y</span> <span class="o">=</span> <span class="n">over_y</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="lico-301"><a href="#lico-301"><span class="linenos">301</span></a>
</span><span id="lico-302"><a href="#lico-302"><span class="linenos">302</span></a>    <span class="k">return</span> <span class="n">over_X</span><span class="p">,</span> <span class="n">over_y</span>
</span></pre></div>


            <div class="docstring"><p>Linear Combination Oversampling (LiCO)</p>

<p>Generates synthetic EEG trials from the minority class by creating weighted linear
combinations of existing trials, with added Gaussian noise for variability.
Automatically detects the minority class based on label distribution.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (numpy.ndarray):
Trials of EEG data.
3D array containing data with <code>float</code> type.
shape = (n_trials, n_channels, n_samples)</li>
<li><strong>y</strong> (numpy.ndarray):
Labels corresponding to X.</li>
<li><strong>expansion_factor</strong> (int, <em>optional</em>):
Controls the amount of oversampling for the minority class.
The minority class size will be increased by this factor.
<ul>
<li>Default is <code>3</code>.</li>
</ul></li>
<li><strong>sum_num</strong> (int, <em>optional</em>):
Number of existing trials to combine for each synthetic trial.
Higher values create more complex combinations.
<ul>
<li>Default is <code>2</code>.</li>
</ul></li>
<li><strong>shuffle</strong> (bool, <em>optional</em>):
Whether to shuffle the final combined dataset.
<ul>
<li>Default is <code>False</code>.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>over_X</strong> (numpy.ndarray):
Original trials combined with synthetic trials.
shape = (n_expanded_trials, n_channels, n_samples)</li>
<li><strong>over_y</strong> (numpy.ndarray):
Labels for original and synthetic trials.
shape = (n_expanded_trials,)</li>
</ul>
</div>


                </section>
                <section id="smote">
                            <input id="smote-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">smote</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">X</span>,</span><span class="param">	<span class="n">y</span>,</span><span class="param">	<span class="n">expansion_factor</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">k_neighbors</span><span class="o">=</span><span class="mi">5</span>,</span><span class="param">	<span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">random_state</span><span class="o">=</span><span class="mi">42</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="smote-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#smote"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="smote-305"><a href="#smote-305"><span class="linenos">305</span></a><span class="k">def</span><span class="w"> </span><span class="nf">smote</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">expansion_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
</span><span id="smote-306"><a href="#smote-306"><span class="linenos">306</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Oversampling using SMOTE (Synthetic Minority Over-sampling Technique)</span>
</span><span id="smote-307"><a href="#smote-307"><span class="linenos">307</span></a>
</span><span id="smote-308"><a href="#smote-308"><span class="linenos">308</span></a><span class="sd">    Generates synthetic EEG trials from minority class (typically target/P300 responses).</span>
</span><span id="smote-309"><a href="#smote-309"><span class="linenos">309</span></a>
</span><span id="smote-310"><a href="#smote-310"><span class="linenos">310</span></a><span class="sd">    Parameters</span>
</span><span id="smote-311"><a href="#smote-311"><span class="linenos">311</span></a><span class="sd">    ----------</span>
</span><span id="smote-312"><a href="#smote-312"><span class="linenos">312</span></a><span class="sd">    X : numpy.ndarray</span>
</span><span id="smote-313"><a href="#smote-313"><span class="linenos">313</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="smote-314"><a href="#smote-314"><span class="linenos">314</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="smote-315"><a href="#smote-315"><span class="linenos">315</span></a><span class="sd">        shape = (n_trials, n_channels, n_samples)</span>
</span><span id="smote-316"><a href="#smote-316"><span class="linenos">316</span></a><span class="sd">    y : numpy.ndarray</span>
</span><span id="smote-317"><a href="#smote-317"><span class="linenos">317</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="smote-318"><a href="#smote-318"><span class="linenos">318</span></a><span class="sd">    expansion_factor : float, *optional*</span>
</span><span id="smote-319"><a href="#smote-319"><span class="linenos">319</span></a><span class="sd">        Controls the amount of oversampling for the minority class.</span>
</span><span id="smote-320"><a href="#smote-320"><span class="linenos">320</span></a><span class="sd">        - Default is `3`.</span>
</span><span id="smote-321"><a href="#smote-321"><span class="linenos">321</span></a><span class="sd">    k_neighbors : int, *optional*</span>
</span><span id="smote-322"><a href="#smote-322"><span class="linenos">322</span></a><span class="sd">        Number of nearest neighbors to use for synthetic sample generation.</span>
</span><span id="smote-323"><a href="#smote-323"><span class="linenos">323</span></a><span class="sd">        - Default is `5`.</span>
</span><span id="smote-324"><a href="#smote-324"><span class="linenos">324</span></a><span class="sd">    shuffle : bool, *optional*</span>
</span><span id="smote-325"><a href="#smote-325"><span class="linenos">325</span></a><span class="sd">        Whether to shuffle the final combined dataset.</span>
</span><span id="smote-326"><a href="#smote-326"><span class="linenos">326</span></a><span class="sd">        - Default is `False`.</span>
</span><span id="smote-327"><a href="#smote-327"><span class="linenos">327</span></a><span class="sd">    random_state : int, *optional*</span>
</span><span id="smote-328"><a href="#smote-328"><span class="linenos">328</span></a><span class="sd">        Random seed for reproducibility.</span>
</span><span id="smote-329"><a href="#smote-329"><span class="linenos">329</span></a><span class="sd">        - Default is `42`.</span>
</span><span id="smote-330"><a href="#smote-330"><span class="linenos">330</span></a>
</span><span id="smote-331"><a href="#smote-331"><span class="linenos">331</span></a><span class="sd">    Returns</span>
</span><span id="smote-332"><a href="#smote-332"><span class="linenos">332</span></a><span class="sd">    -------</span>
</span><span id="smote-333"><a href="#smote-333"><span class="linenos">333</span></a><span class="sd">    over_X : numpy.ndarray</span>
</span><span id="smote-334"><a href="#smote-334"><span class="linenos">334</span></a><span class="sd">        Oversampled X.</span>
</span><span id="smote-335"><a href="#smote-335"><span class="linenos">335</span></a><span class="sd">    over_y : numpy.ndarray</span>
</span><span id="smote-336"><a href="#smote-336"><span class="linenos">336</span></a><span class="sd">        Oversampled y.</span>
</span><span id="smote-337"><a href="#smote-337"><span class="linenos">337</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="smote-338"><a href="#smote-338"><span class="linenos">338</span></a>
</span><span id="smote-339"><a href="#smote-339"><span class="linenos">339</span></a>    <span class="c1"># Get dimensions</span>
</span><span id="smote-340"><a href="#smote-340"><span class="linenos">340</span></a>    <span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</span><span id="smote-341"><a href="#smote-341"><span class="linenos">341</span></a>
</span><span id="smote-342"><a href="#smote-342"><span class="linenos">342</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="smote-343"><a href="#smote-343"><span class="linenos">343</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="smote-344"><a href="#smote-344"><span class="linenos">344</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="smote-345"><a href="#smote-345"><span class="linenos">345</span></a>    <span class="n">n_minority</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">)</span> <span class="o">*</span> <span class="n">expansion_factor</span><span class="p">)</span>
</span><span id="smote-346"><a href="#smote-346"><span class="linenos">346</span></a>    <span class="n">sampling_strategy</span> <span class="o">=</span> <span class="p">{</span><span class="n">minority_class</span><span class="p">:</span> <span class="n">n_minority</span><span class="p">}</span>
</span><span id="smote-347"><a href="#smote-347"><span class="linenos">347</span></a>
</span><span id="smote-348"><a href="#smote-348"><span class="linenos">348</span></a>    <span class="c1"># Reshape X to 2D for SMOTE (combine channels and samples)</span>
</span><span id="smote-349"><a href="#smote-349"><span class="linenos">349</span></a>    <span class="n">X_reshaped</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_trials</span><span class="p">,</span> <span class="n">n_channels</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="smote-350"><a href="#smote-350"><span class="linenos">350</span></a>
</span><span id="smote-351"><a href="#smote-351"><span class="linenos">351</span></a>    <span class="c1"># Apply SMOTE</span>
</span><span id="smote-352"><a href="#smote-352"><span class="linenos">352</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="smote-353"><a href="#smote-353"><span class="linenos">353</span></a>        <span class="c1"># If not enough minority samples for k_neighbors, reduce k</span>
</span><span id="smote-354"><a href="#smote-354"><span class="linenos">354</span></a>        <span class="k">if</span> <span class="n">n_minority</span> <span class="o">&lt;=</span> <span class="n">k_neighbors</span><span class="p">:</span>
</span><span id="smote-355"><a href="#smote-355"><span class="linenos">355</span></a>            <span class="n">k_neighbors</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_minority</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="smote-356"><a href="#smote-356"><span class="linenos">356</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="smote-357"><a href="#smote-357"><span class="linenos">357</span></a>                <span class="s2">&quot;Reduced k_neighbors to </span><span class="si">%s</span><span class="s2"> due to small minority class&quot;</span><span class="p">,</span> <span class="n">k_neighbors</span>
</span><span id="smote-358"><a href="#smote-358"><span class="linenos">358</span></a>            <span class="p">)</span>
</span><span id="smote-359"><a href="#smote-359"><span class="linenos">359</span></a>
</span><span id="smote-360"><a href="#smote-360"><span class="linenos">360</span></a>        <span class="c1"># Configure and apply SMOTE</span>
</span><span id="smote-361"><a href="#smote-361"><span class="linenos">361</span></a>        <span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span>
</span><span id="smote-362"><a href="#smote-362"><span class="linenos">362</span></a>            <span class="n">sampling_strategy</span><span class="o">=</span><span class="n">sampling_strategy</span><span class="p">,</span>
</span><span id="smote-363"><a href="#smote-363"><span class="linenos">363</span></a>            <span class="n">k_neighbors</span><span class="o">=</span><span class="n">k_neighbors</span><span class="p">,</span>
</span><span id="smote-364"><a href="#smote-364"><span class="linenos">364</span></a>            <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
</span><span id="smote-365"><a href="#smote-365"><span class="linenos">365</span></a>        <span class="p">)</span>
</span><span id="smote-366"><a href="#smote-366"><span class="linenos">366</span></a>        <span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_reshaped</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="smote-367"><a href="#smote-367"><span class="linenos">367</span></a>
</span><span id="smote-368"><a href="#smote-368"><span class="linenos">368</span></a>        <span class="c1"># Reshape back to 3D</span>
</span><span id="smote-369"><a href="#smote-369"><span class="linenos">369</span></a>        <span class="n">X_resampled</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_channels</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
</span><span id="smote-370"><a href="#smote-370"><span class="linenos">370</span></a>
</span><span id="smote-371"><a href="#smote-371"><span class="linenos">371</span></a>        <span class="c1"># Shuffle if requested</span>
</span><span id="smote-372"><a href="#smote-372"><span class="linenos">372</span></a>        <span class="k">if</span> <span class="n">shuffle</span><span class="p">:</span>
</span><span id="smote-373"><a href="#smote-373"><span class="linenos">373</span></a>            <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">))</span>
</span><span id="smote-374"><a href="#smote-374"><span class="linenos">374</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
</span><span id="smote-375"><a href="#smote-375"><span class="linenos">375</span></a>            <span class="n">X_resampled</span> <span class="o">=</span> <span class="n">X_resampled</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="smote-376"><a href="#smote-376"><span class="linenos">376</span></a>            <span class="n">y_resampled</span> <span class="o">=</span> <span class="n">y_resampled</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
</span><span id="smote-377"><a href="#smote-377"><span class="linenos">377</span></a>
</span><span id="smote-378"><a href="#smote-378"><span class="linenos">378</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="smote-379"><a href="#smote-379"><span class="linenos">379</span></a>            <span class="s2">&quot;SMOTE expanded data from </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2"> samples&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">)</span>
</span><span id="smote-380"><a href="#smote-380"><span class="linenos">380</span></a>        <span class="p">)</span>
</span><span id="smote-381"><a href="#smote-381"><span class="linenos">381</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;New class balance: </span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_resampled</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_resampled</span><span class="p">))</span>
</span><span id="smote-382"><a href="#smote-382"><span class="linenos">382</span></a>
</span><span id="smote-383"><a href="#smote-383"><span class="linenos">383</span></a>        <span class="k">return</span> <span class="n">X_resampled</span><span class="p">,</span> <span class="n">y_resampled</span>
</span><span id="smote-384"><a href="#smote-384"><span class="linenos">384</span></a>
</span><span id="smote-385"><a href="#smote-385"><span class="linenos">385</span></a>    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="smote-386"><a href="#smote-386"><span class="linenos">386</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;SMOTE failed: </span><span class="si">%s</span><span class="s2">. Returning original data.&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span><span id="smote-387"><a href="#smote-387"><span class="linenos">387</span></a>        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</span></pre></div>


            <div class="docstring"><p>Oversampling using SMOTE (Synthetic Minority Over-sampling Technique)</p>

<p>Generates synthetic EEG trials from minority class (typically target/P300 responses).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (numpy.ndarray):
Trials of EEG data.
3D array containing data with <code>float</code> type.
shape = (n_trials, n_channels, n_samples)</li>
<li><strong>y</strong> (numpy.ndarray):
Labels corresponding to X.</li>
<li><strong>expansion_factor</strong> (float, <em>optional</em>):
Controls the amount of oversampling for the minority class.
<ul>
<li>Default is <code>3</code>.</li>
</ul></li>
<li><strong>k_neighbors</strong> (int, <em>optional</em>):
Number of nearest neighbors to use for synthetic sample generation.
<ul>
<li>Default is <code>5</code>.</li>
</ul></li>
<li><strong>shuffle</strong> (bool, <em>optional</em>):
Whether to shuffle the final combined dataset.
<ul>
<li>Default is <code>False</code>.</li>
</ul></li>
<li><strong>random_state</strong> (int, <em>optional</em>):
Random seed for reproducibility.
<ul>
<li>Default is <code>42</code>.</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>over_X</strong> (numpy.ndarray):
Oversampled X.</li>
<li><strong>over_y</strong> (numpy.ndarray):
Oversampled y.</li>
</ul>
</div>


                </section>
                <section id="random_oversampling">
                            <input id="random_oversampling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">random_oversampling</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">ratio</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="random_oversampling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#random_oversampling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="random_oversampling-390"><a href="#random_oversampling-390"><span class="linenos">390</span></a><span class="k">def</span><span class="w"> </span><span class="nf">random_oversampling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
</span><span id="random_oversampling-391"><a href="#random_oversampling-391"><span class="linenos">391</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Oversampling</span>
</span><span id="random_oversampling-392"><a href="#random_oversampling-392"><span class="linenos">392</span></a>
</span><span id="random_oversampling-393"><a href="#random_oversampling-393"><span class="linenos">393</span></a><span class="sd">    Randomly samples epochs of X to oversample the MINORITY class.</span>
</span><span id="random_oversampling-394"><a href="#random_oversampling-394"><span class="linenos">394</span></a><span class="sd">    Automatically determines which class is the MINORITY class.</span>
</span><span id="random_oversampling-395"><a href="#random_oversampling-395"><span class="linenos">395</span></a>
</span><span id="random_oversampling-396"><a href="#random_oversampling-396"><span class="linenos">396</span></a><span class="sd">    Parameters</span>
</span><span id="random_oversampling-397"><a href="#random_oversampling-397"><span class="linenos">397</span></a><span class="sd">    ----------</span>
</span><span id="random_oversampling-398"><a href="#random_oversampling-398"><span class="linenos">398</span></a><span class="sd">    X : numpy.ndarray [n_trials, n_channels, n_samples]</span>
</span><span id="random_oversampling-399"><a href="#random_oversampling-399"><span class="linenos">399</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="random_oversampling-400"><a href="#random_oversampling-400"><span class="linenos">400</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="random_oversampling-401"><a href="#random_oversampling-401"><span class="linenos">401</span></a><span class="sd">    y : numpy.ndarray [n_trials]</span>
</span><span id="random_oversampling-402"><a href="#random_oversampling-402"><span class="linenos">402</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="random_oversampling-403"><a href="#random_oversampling-403"><span class="linenos">403</span></a><span class="sd">    ratio : float</span>
</span><span id="random_oversampling-404"><a href="#random_oversampling-404"><span class="linenos">404</span></a><span class="sd">        Desired ratio of MINORITY class samples to majority class samples</span>
</span><span id="random_oversampling-405"><a href="#random_oversampling-405"><span class="linenos">405</span></a><span class="sd">        - ratio=1 means the number of MINORITY class samples will be equal to the number of majority class samples</span>
</span><span id="random_oversampling-406"><a href="#random_oversampling-406"><span class="linenos">406</span></a><span class="sd">        - ratio=0.5 means the number of MINORITY class samples will be half the number of majority class samples</span>
</span><span id="random_oversampling-407"><a href="#random_oversampling-407"><span class="linenos">407</span></a><span class="sd">        - ratio=2 means the number of MINORITY class samples will be twice the number of majority class samples</span>
</span><span id="random_oversampling-408"><a href="#random_oversampling-408"><span class="linenos">408</span></a>
</span><span id="random_oversampling-409"><a href="#random_oversampling-409"><span class="linenos">409</span></a><span class="sd">    Returns</span>
</span><span id="random_oversampling-410"><a href="#random_oversampling-410"><span class="linenos">410</span></a><span class="sd">    -------</span>
</span><span id="random_oversampling-411"><a href="#random_oversampling-411"><span class="linenos">411</span></a><span class="sd">    over_X : numpy.ndarray</span>
</span><span id="random_oversampling-412"><a href="#random_oversampling-412"><span class="linenos">412</span></a><span class="sd">        Oversampled X.</span>
</span><span id="random_oversampling-413"><a href="#random_oversampling-413"><span class="linenos">413</span></a><span class="sd">    over_y : numpy.ndarray</span>
</span><span id="random_oversampling-414"><a href="#random_oversampling-414"><span class="linenos">414</span></a><span class="sd">        Oversampled y.</span>
</span><span id="random_oversampling-415"><a href="#random_oversampling-415"><span class="linenos">415</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="random_oversampling-416"><a href="#random_oversampling-416"><span class="linenos">416</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="random_oversampling-417"><a href="#random_oversampling-417"><span class="linenos">417</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="random_oversampling-418"><a href="#random_oversampling-418"><span class="linenos">418</span></a>
</span><span id="random_oversampling-419"><a href="#random_oversampling-419"><span class="linenos">419</span></a>    <span class="c1"># Determine minority and majority classes</span>
</span><span id="random_oversampling-420"><a href="#random_oversampling-420"><span class="linenos">420</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="random_oversampling-421"><a href="#random_oversampling-421"><span class="linenos">421</span></a>    <span class="n">n_minority</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="random_oversampling-422"><a href="#random_oversampling-422"><span class="linenos">422</span></a>    <span class="n">n_majority</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="random_oversampling-423"><a href="#random_oversampling-423"><span class="linenos">423</span></a>
</span><span id="random_oversampling-424"><a href="#random_oversampling-424"><span class="linenos">424</span></a>    <span class="c1"># Get minority class samples</span>
</span><span id="random_oversampling-425"><a href="#random_oversampling-425"><span class="linenos">425</span></a>    <span class="n">minority_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">]</span>
</span><span id="random_oversampling-426"><a href="#random_oversampling-426"><span class="linenos">426</span></a>
</span><span id="random_oversampling-427"><a href="#random_oversampling-427"><span class="linenos">427</span></a>    <span class="c1"># Calculate number of samples needed</span>
</span><span id="random_oversampling-428"><a href="#random_oversampling-428"><span class="linenos">428</span></a>    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_majority</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_minority</span>
</span><span id="random_oversampling-429"><a href="#random_oversampling-429"><span class="linenos">429</span></a>
</span><span id="random_oversampling-430"><a href="#random_oversampling-430"><span class="linenos">430</span></a>    <span class="c1"># Generate new samples</span>
</span><span id="random_oversampling-431"><a href="#random_oversampling-431"><span class="linenos">431</span></a>    <span class="n">new_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
</span><span id="random_oversampling-432"><a href="#random_oversampling-432"><span class="linenos">432</span></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
</span><span id="random_oversampling-433"><a href="#random_oversampling-433"><span class="linenos">433</span></a>        <span class="n">new_X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">minority_X</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_minority</span><span class="p">)),</span> <span class="p">:,</span> <span class="p">:]</span>
</span><span id="random_oversampling-434"><a href="#random_oversampling-434"><span class="linenos">434</span></a>
</span><span id="random_oversampling-435"><a href="#random_oversampling-435"><span class="linenos">435</span></a>    <span class="n">over_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="random_oversampling-436"><a href="#random_oversampling-436"><span class="linenos">436</span></a>    <span class="n">over_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">n_samples</span><span class="p">])</span> <span class="o">*</span> <span class="n">minority_class</span><span class="p">)</span>
</span><span id="random_oversampling-437"><a href="#random_oversampling-437"><span class="linenos">437</span></a>
</span><span id="random_oversampling-438"><a href="#random_oversampling-438"><span class="linenos">438</span></a>    <span class="k">return</span> <span class="n">over_X</span><span class="p">,</span> <span class="n">over_y</span>
</span></pre></div>


            <div class="docstring"><p>Random Oversampling</p>

<p>Randomly samples epochs of X to oversample the MINORITY class.
Automatically determines which class is the MINORITY class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (numpy.ndarray [n_trials, n_channels, n_samples]):
Trials of EEG data.
3D array containing data with <code>float</code> type.</li>
<li><strong>y</strong> (numpy.ndarray [n_trials]):
Labels corresponding to X.</li>
<li><strong>ratio</strong> (float):
Desired ratio of MINORITY class samples to majority class samples
<ul>
<li>ratio=1 means the number of MINORITY class samples will be equal to the number of majority class samples</li>
<li>ratio=0.5 means the number of MINORITY class samples will be half the number of majority class samples</li>
<li>ratio=2 means the number of MINORITY class samples will be twice the number of majority class samples</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>over_X</strong> (numpy.ndarray):
Oversampled X.</li>
<li><strong>over_y</strong> (numpy.ndarray):
Oversampled y.</li>
</ul>
</div>


                </section>
                <section id="random_undersampling">
                            <input id="random_undersampling-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">random_undersampling</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">y</span>, </span><span class="param"><span class="n">ratio</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="random_undersampling-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#random_undersampling"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="random_undersampling-441"><a href="#random_undersampling-441"><span class="linenos">441</span></a><span class="k">def</span><span class="w"> </span><span class="nf">random_undersampling</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ratio</span><span class="p">):</span>
</span><span id="random_undersampling-442"><a href="#random_undersampling-442"><span class="linenos">442</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Random Undersampling</span>
</span><span id="random_undersampling-443"><a href="#random_undersampling-443"><span class="linenos">443</span></a>
</span><span id="random_undersampling-444"><a href="#random_undersampling-444"><span class="linenos">444</span></a><span class="sd">    Randomly removes epochs of X to undersample the MAJORITY class.</span>
</span><span id="random_undersampling-445"><a href="#random_undersampling-445"><span class="linenos">445</span></a><span class="sd">    Automatically determines which class is the MAJORITYajority class.</span>
</span><span id="random_undersampling-446"><a href="#random_undersampling-446"><span class="linenos">446</span></a>
</span><span id="random_undersampling-447"><a href="#random_undersampling-447"><span class="linenos">447</span></a><span class="sd">    Parameters</span>
</span><span id="random_undersampling-448"><a href="#random_undersampling-448"><span class="linenos">448</span></a><span class="sd">    ----------</span>
</span><span id="random_undersampling-449"><a href="#random_undersampling-449"><span class="linenos">449</span></a><span class="sd">    X : numpy.ndarray [n_trials, n_channels, n_samples]</span>
</span><span id="random_undersampling-450"><a href="#random_undersampling-450"><span class="linenos">450</span></a><span class="sd">        Trials of EEG data.</span>
</span><span id="random_undersampling-451"><a href="#random_undersampling-451"><span class="linenos">451</span></a><span class="sd">        3D array containing data with `float` type.</span>
</span><span id="random_undersampling-452"><a href="#random_undersampling-452"><span class="linenos">452</span></a><span class="sd">    y : numpy.ndarray [n_trials]</span>
</span><span id="random_undersampling-453"><a href="#random_undersampling-453"><span class="linenos">453</span></a><span class="sd">        Labels corresponding to X.</span>
</span><span id="random_undersampling-454"><a href="#random_undersampling-454"><span class="linenos">454</span></a><span class="sd">    ratio : float</span>
</span><span id="random_undersampling-455"><a href="#random_undersampling-455"><span class="linenos">455</span></a><span class="sd">        Desired ratio of MAJORITY class samples to minority class samples.</span>
</span><span id="random_undersampling-456"><a href="#random_undersampling-456"><span class="linenos">456</span></a><span class="sd">        - ratio=1 means the number of MAJORITY class samples will be equal to the number of minority class samples</span>
</span><span id="random_undersampling-457"><a href="#random_undersampling-457"><span class="linenos">457</span></a><span class="sd">        - ratio=0.5 means the number of MAJORITY class samples will be half the number of minority class samples</span>
</span><span id="random_undersampling-458"><a href="#random_undersampling-458"><span class="linenos">458</span></a><span class="sd">        - ratio=2 means the number of MAJORITY class samples will be twice the number of minority class samples</span>
</span><span id="random_undersampling-459"><a href="#random_undersampling-459"><span class="linenos">459</span></a>
</span><span id="random_undersampling-460"><a href="#random_undersampling-460"><span class="linenos">460</span></a><span class="sd">    Returns</span>
</span><span id="random_undersampling-461"><a href="#random_undersampling-461"><span class="linenos">461</span></a><span class="sd">    -------</span>
</span><span id="random_undersampling-462"><a href="#random_undersampling-462"><span class="linenos">462</span></a><span class="sd">    under_X : numpy.ndarray</span>
</span><span id="random_undersampling-463"><a href="#random_undersampling-463"><span class="linenos">463</span></a><span class="sd">        Undersampled X.</span>
</span><span id="random_undersampling-464"><a href="#random_undersampling-464"><span class="linenos">464</span></a><span class="sd">    under_y : numpy.ndarray</span>
</span><span id="random_undersampling-465"><a href="#random_undersampling-465"><span class="linenos">465</span></a><span class="sd">        Undersampled y.</span>
</span><span id="random_undersampling-466"><a href="#random_undersampling-466"><span class="linenos">466</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="random_undersampling-467"><a href="#random_undersampling-467"><span class="linenos">467</span></a>    <span class="c1"># Find unique classes and their counts</span>
</span><span id="random_undersampling-468"><a href="#random_undersampling-468"><span class="linenos">468</span></a>    <span class="n">classes</span><span class="p">,</span> <span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="random_undersampling-469"><a href="#random_undersampling-469"><span class="linenos">469</span></a>
</span><span id="random_undersampling-470"><a href="#random_undersampling-470"><span class="linenos">470</span></a>    <span class="c1"># Determine minority and majority classes</span>
</span><span id="random_undersampling-471"><a href="#random_undersampling-471"><span class="linenos">471</span></a>    <span class="n">majority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="random_undersampling-472"><a href="#random_undersampling-472"><span class="linenos">472</span></a>    <span class="n">minority_class</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">counts</span><span class="p">)]</span>
</span><span id="random_undersampling-473"><a href="#random_undersampling-473"><span class="linenos">473</span></a>    <span class="n">n_minority</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</span><span id="random_undersampling-474"><a href="#random_undersampling-474"><span class="linenos">474</span></a>
</span><span id="random_undersampling-475"><a href="#random_undersampling-475"><span class="linenos">475</span></a>    <span class="c1"># Calculate number of majority samples to keep</span>
</span><span id="random_undersampling-476"><a href="#random_undersampling-476"><span class="linenos">476</span></a>    <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_minority</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">)</span>
</span><span id="random_undersampling-477"><a href="#random_undersampling-477"><span class="linenos">477</span></a>
</span><span id="random_undersampling-478"><a href="#random_undersampling-478"><span class="linenos">478</span></a>    <span class="c1"># Get indices of majority class samples</span>
</span><span id="random_undersampling-479"><a href="#random_undersampling-479"><span class="linenos">479</span></a>    <span class="n">majority_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">majority_class</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="random_undersampling-480"><a href="#random_undersampling-480"><span class="linenos">480</span></a>
</span><span id="random_undersampling-481"><a href="#random_undersampling-481"><span class="linenos">481</span></a>    <span class="c1"># Randomly select indices to keep</span>
</span><span id="random_undersampling-482"><a href="#random_undersampling-482"><span class="linenos">482</span></a>    <span class="n">keep_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">majority_indices</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="random_undersampling-483"><a href="#random_undersampling-483"><span class="linenos">483</span></a>
</span><span id="random_undersampling-484"><a href="#random_undersampling-484"><span class="linenos">484</span></a>    <span class="c1"># Get indices of minority class samples</span>
</span><span id="random_undersampling-485"><a href="#random_undersampling-485"><span class="linenos">485</span></a>    <span class="n">minority_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">minority_class</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="random_undersampling-486"><a href="#random_undersampling-486"><span class="linenos">486</span></a>
</span><span id="random_undersampling-487"><a href="#random_undersampling-487"><span class="linenos">487</span></a>    <span class="c1"># Combine indices</span>
</span><span id="random_undersampling-488"><a href="#random_undersampling-488"><span class="linenos">488</span></a>    <span class="n">all_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">keep_indices</span><span class="p">,</span> <span class="n">minority_indices</span><span class="p">])</span>
</span><span id="random_undersampling-489"><a href="#random_undersampling-489"><span class="linenos">489</span></a>
</span><span id="random_undersampling-490"><a href="#random_undersampling-490"><span class="linenos">490</span></a>    <span class="c1"># Create undersampled datasets</span>
</span><span id="random_undersampling-491"><a href="#random_undersampling-491"><span class="linenos">491</span></a>    <span class="n">under_X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">all_indices</span><span class="p">]</span>
</span><span id="random_undersampling-492"><a href="#random_undersampling-492"><span class="linenos">492</span></a>    <span class="n">under_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">all_indices</span><span class="p">]</span>
</span><span id="random_undersampling-493"><a href="#random_undersampling-493"><span class="linenos">493</span></a>
</span><span id="random_undersampling-494"><a href="#random_undersampling-494"><span class="linenos">494</span></a>    <span class="k">return</span> <span class="n">under_X</span><span class="p">,</span> <span class="n">under_y</span>
</span></pre></div>


            <div class="docstring"><p>Random Undersampling</p>

<p>Randomly removes epochs of X to undersample the MAJORITY class.
Automatically determines which class is the MAJORITYajority class.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>X</strong> (numpy.ndarray [n_trials, n_channels, n_samples]):
Trials of EEG data.
3D array containing data with <code>float</code> type.</li>
<li><strong>y</strong> (numpy.ndarray [n_trials]):
Labels corresponding to X.</li>
<li><strong>ratio</strong> (float):
Desired ratio of MAJORITY class samples to minority class samples.
<ul>
<li>ratio=1 means the number of MAJORITY class samples will be equal to the number of minority class samples</li>
<li>ratio=0.5 means the number of MAJORITY class samples will be half the number of minority class samples</li>
<li>ratio=2 means the number of MAJORITY class samples will be twice the number of minority class samples</li>
</ul></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>under_X</strong> (numpy.ndarray):
Undersampled X.</li>
<li><strong>under_y</strong> (numpy.ndarray):
Undersampled y.</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>